<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Near</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: system-ui, sans-serif;
  background: #0f172a;
  color: white;
  margin: 0;
  padding: 16px;
}
.card {
  background: #1e293b;
  border-radius: 14px;
  padding: 16px;
  margin-bottom: 12px;
}
.small {
  color: #94a3b8;
  font-size: 14px;
}
button {
  width: 100%;
  padding: 14px;
  border-radius: 12px;
  border: none;
  background: #38bdf8;
  font-size: 16px;
  font-weight: bold;
}
</style>
</head>

<body>

<h2>üìç Near</h2>
<p class="small">Find people close to you right now</p>

<button onclick="getLocation()">Enable location</button>

<div id="list"></div>

<script>
function getLocation() {
  if (!navigator.geolocation) {
    alert("Geolocation not supported");
    return;
  }

  navigator.geolocation.getCurrentPosition(
    pos => {
      const me = {
        lat: pos.coords.latitude,
        lng: pos.coords.longitude
      };
      showNearby(me);
    },
    err => {
      alert("Location permission denied");
    }
  );
}

function distanceKm(a, b) {
  const R = 6371;
  const dLat = (b.lat - a.lat) * Math.PI / 180;
  const dLng = (b.lng - a.lng) * Math.PI / 180;
  const x =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(a.lat * Math.PI / 180) *
    Math.cos(b.lat * Math.PI / 180) *
    Math.sin(dLng / 2) * Math.sin(dLng / 2);
  return R * 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x));
}

function showNearby(me) {
  const fakeUsers = [
    { name: "Alex", lat: me.lat + 0.0005, lng: me.lng + 0.0005 },
    { name: "Sam", lat: me.lat + 0.001, lng: me.lng - 0.0003 },
    { name: "Jamie", lat: me.lat - 0.0007, lng: me.lng + 0.0002 }
  ];

  const list = document.getElementById("list");
  list.innerHTML = "";

  fakeUsers.forEach(u => {
    const km = distanceKm(me, u);
    const meters = Math.round(km * 1000);

    const line = pickupLine(meters);

    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <b>${u.name}</b><br>
      <span class="small">${meters}m away</span><br><br>
      "${line}"
    `;
    list.appendChild(div);
  });
}

function pickupLine(m) {
  if (m < 50) return "You‚Äôre closer than my Wi-Fi signal.";
  if (m < 100) return "If we walk fast, we could meet in 30 seconds.";
  return "You‚Äôre nearby. That‚Äôs already interesting.";
}
</script>

</body>
</html>
